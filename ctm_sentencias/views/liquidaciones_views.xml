<?xml version="1.0" encoding="UTF-8" ?>

<odoo>

    <record id="model_ctm_liquidaciones_view_tree" model="ir.ui.view">
        <field name="name">ctm.liquidaciones.view.tree</field>
        <field name="model">ctm.liquidaciones</field>
        <field name="arch" type="xml">
            <tree string="">
                <field name="name" />
                <field name="statum"/>
                <field name="emisor" />
                <field name="pagador" />
                <field name="valor_condena" />
                <field name="total_intereses" />
                <field name="resultado" />
                <field name="tir_sentencia_bruta" />
            </tree>
        </field>
    </record>

    <record id="model_ctm_liquidaciones_view_form" model="ir.ui.view">
        <field name="name">ctm.liquidaciones.view.form</field>
        <field name="model">ctm.liquidaciones</field>
        <field name="arch" type="xml">
            <form string="">
                <header>
                    <button name="generar_liquidacion" type="object" string="Generar Liquidación" attrs="{'invisible': [('state', 'in', ['liquidated'])]}"/>
                    <button name="set_borrador_liquidacion" type="object" string="Pasar a borrador" attrs="{'invisible': [('state', '=', 'draft')]}"/>
                    <button name="generar_simulacion" type="object" string="Generar Simulación" attrs="{'invisible': [('state', 'not in', ['liquidated'])]}"/>
                    <button name="action_view_simulaciones"
                            type="object"
                            string="Simulaciones"
                            class="oe_stat_button"
                            icon="fa-calculator"
                    />
                    <field name="state" widget="statusbar" />
                </header>
                <sheet>
                    <div class="oe_title">
                        <div class="o_row">
                            <h3 style="display: flex;"><field name="name" readonly="1" class="oe_inline"/></h3>
                        </div>
                    </div>
                    <group name="cliente">
                        <group name="izquierda">
                            <field name="sentencia" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"/>
                            <field name="emisor" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"
                                   options='{"always_reload": True, "no_quick_create": True, "no_create_edit": True,
                                            "no_create":True, "no_open":True}'
                            />
                            <field name="pagador" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"
                                   options='{"always_reload": True, "no_quick_create": True, "no_create_edit": True,
                                            "no_create":True, "no_open":True}'
                            />
                            <field name="codigo" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"/>

                        </group>
                        <group name="derecha">
                            <field name="fecha_ejecutoria" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"/>
                            <field name="fecha_cuenta_cobro" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"/>
                            <field name="fecha_liquidar"/>
                            <field name="valor_condena" attrs="{'readonly': [('state', 'in', ['liquidated', 'draft'])]}"/>
                            <field name="total_intereses" readonly="1"/>
                            <field name="valor_contable_ayer" readonly="1"/>
                            <field name="precio" readonly="1"/>
                            <field name="resultado" readonly="1"/>
                            <field name="tir_sentencia_bruta" readonly="1"/>
                            <field name="responsible" readonly="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="liquidaciones_resumen" string="Resumen">
                            <field name="liquidaciones_resumen_ids" readonly="1">
                                <tree editable="bottom">
                                    <field name="fecha"/>
                                    <field name="tasa"/>
                                    <field name="interes"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="create_txt_action" model="ir.actions.server">
        <field name="name">Crear TXT</field>
        <field name="state">code</field>
        <field name="type">ir.actions.server</field>
        <field name="model_id" ref="model_ctm_liquidaciones"/>
        <field name="binding_model_id" ref="model_ctm_liquidaciones" />
        <field name="binding_view_types">list</field>
        <field name="code">
            if records:
                action = records.create_txt()
        </field>
    </record>
    <record id="create_excel_action" model="ir.actions.server">
        <field name="name">Crear Excel</field>
        <field name="state">code</field>
        <field name="type">ir.actions.server</field>
        <field name="model_id" ref="model_ctm_liquidaciones"/>
        <field name="binding_model_id" ref="model_ctm_liquidaciones" />
        <field name="binding_view_types">list</field>
        <field name="code">
            if records:
                action = records.create_excel()
        </field>
    </record>
</odoo>